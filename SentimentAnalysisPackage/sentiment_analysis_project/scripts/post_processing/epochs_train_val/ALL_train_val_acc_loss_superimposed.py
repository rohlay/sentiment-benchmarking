import matplotlib.pyplot as plt
import numpy as np

# Example data with the redundant 'label' removed
N_epochs_DL = 15  # Adjust this as necessary
N_epochs_TF = 4  # Adjust this as necessary

# DATA = SST2_1

models_data1 = {
    'MLP': {
        'Train_Acc': [0.7403125166893005, 0.782474935054779, 0.7919479608535767, 0.797448992729187, 0.8025770783424377, 0.8104836940765381, 0.8125908970832825, 0.8154439926147461, 0.8187446594238281, 0.8199753761291504, 0.8233879208564758, 0.8263342380523682, 0.826968252658844, 0.8285160064697266, 0.8310893774032593],
        'Train_Loss': [0.5280630588531494, 0.47458919882774353, 0.4571123719215393, 0.4461638331413269, 0.4389374852180481, 0.42645901441574097, 0.42202961444854736, 0.41501903533935547, 0.4105319678783417, 0.4069584906101227, 0.40163853764533997, 0.397494912147522, 0.3950704336166382, 0.3931514322757721, 0.3866216540336609],
        'Val_Acc': [0.7908555269241333, 0.7976430058479309, 0.8045796751976013, 0.810024619102478, 0.8169612884521484, 0.816364586353302, 0.8210636377334595, 0.8229283094406128, 0.8280748724937439, 0.8277019262313843, 0.8301633596420288, 0.8329976797103882, 0.8338927626609802, 0.8353099226951599, 0.8388901352882385],
        'Val_Loss': [0.45460209250450134, 0.44094109535217285, 0.4286123812198639, 0.41882094740867615, 0.4111679494380951, 0.4118380546569824, 0.3989301025867462, 0.39399710297584534, 0.3900335729122162, 0.3907005786895752, 0.3888159990310669, 0.38258111476898193, 0.3830885887145996, 0.3794887959957123, 0.376716285943985],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'CNN': {
        'Train_Acc': [0.646421492099762, 0.6948494911193848, 0.7087420225143433, 0.7176369428634644, 0.7218140363693237, 0.7275575399398804, 0.7313616275787354, 0.7354641556739807, 0.7429978251457214, 0.7445828318595886, 0.7471562027931213, 0.7517995238304138, 0.7527132630348206, 0.7565733194351196, 0.7581583857536316],
        'Train_Loss': [0.6268441677093506, 0.5818923115730286, 0.5614352822303772, 0.5528185367584229, 0.5451001524925232, 0.5373831987380981, 0.5297794938087463, 0.5251173377037048, 0.5182890892028809, 0.5116629004478455, 0.5095157623291016, 0.5029621124267578, 0.4999683201313019, 0.49738186597824097, 0.4924934506416321],
        'Val_Acc': [0.6976206302642822, 0.7117177844047546, 0.7083613276481628, 0.7128365635871887, 0.7170134782791138, 0.7094055414199829, 0.7329753041267395, 0.7322294116020203, 0.7367047071456909, 0.7110464572906494, 0.7428954839706421, 0.734541654586792, 0.7391660809516907, 0.7505780458450317, 0.7483404278755188],
        'Val_Loss': [0.5866148471832275, 0.5609935522079468, 0.5543216466903687, 0.5614852905273438, 0.5480287075042725, 0.5578920245170593, 0.5274492502212524, 0.5268547534942627, 0.5222018361091614, 0.5560338497161865, 0.5187031626701355, 0.5278877019882202, 0.5150685906410217, 0.5069602131843567, 0.5053796172142029],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'RNN': {
        'Train_Acc': [0.7236228585243225, 0.743370771408081, 0.7547085285186768, 0.7594823241233826, 0.7644426226615906, 0.768284022808075, 0.7724051475524902, 0.7771230340003967, 0.7801812291145325, 0.7843769788742065, 0.7828665375709534, 0.7863536477088928, 0.7902323603630066, 0.789113461971283, 0.7967404127120972],
        'Train_Loss': [0.5389851927757263, 0.5168284773826599, 0.4989835321903229, 0.4912647306919098, 0.4838959872722626, 0.48041024804115295, 0.4741634726524353, 0.46435311436653137, 0.46113651990890503, 0.4520343244075775, 0.45669835805892944, 0.451353520154953, 0.4480915069580078, 0.4486345648765564, 0.4340810179710388],
        'Val_Acc': [0.7262623906135559, 0.7478182911872864, 0.7303647398948669, 0.7613933086395264, 0.751398503780365, 0.7472962141036987, 0.7645260095596313, 0.7710151672363281, 0.7751174569129944, 0.7725068926811218, 0.7704930305480957, 0.7746699452400208, 0.7843663692474365, 0.78168123960495, 0.779518187046051],
        'Val_Loss': [0.530576765537262, 0.5051789283752441, 0.5344845652580261, 0.4825063943862915, 0.5081067085266113, 0.5046193599700928, 0.48668283224105835, 0.4791106879711151, 0.4680091440677643, 0.48473548889160156, 0.4801090955734253, 0.47036635875701904, 0.45508816838264465, 0.4570018947124481, 0.4553026258945465],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'LSTM': {
        'Train_Acc': [0.6187297105789185, 0.6831014752388, 0.696341335773468, 0.7095625400543213, 0.7195203900337219, 0.7311565279960632, 0.7379629015922546, 0.7455898523330688, 0.752135157585144, 0.757375180721283, 0.7652444839477539, 0.7700182795524597, 0.7753515243530273, 0.779994785785675, 0.788199782371521],
        'Train_Loss': [0.6441648006439209, 0.5906595587730408, 0.5731194019317627, 0.5584167242050171, 0.5477322936058044, 0.5338645577430725, 0.5228525400161743, 0.5133535265922546, 0.504418134689331, 0.4956718385219574, 0.48670339584350586, 0.47805875539779663, 0.4686107933521271, 0.4592962861061096, 0.44851982593536377],
        'Val_Acc': [0.6640560626983643, 0.6884463429450989, 0.7023942470550537, 0.7130603194236755, 0.7254419326782227, 0.7317818999290466, 0.7298426032066345, 0.7211904525756836, 0.7501305341720581, 0.7426717281341553, 0.7548295855522156, 0.754456639289856, 0.7569180130958557, 0.766017735004425, 0.7604236602783203],
        'Val_Loss': [0.6069639921188354, 0.5808297395706177, 0.5659984350204468, 0.5521641969680786, 0.540982723236084, 0.5253297090530396, 0.5313506722450256, 0.5343418717384338, 0.5043997168540955, 0.5157902240753174, 0.4970165193080902, 0.49426549673080444, 0.4935286343097687, 0.48192816972732544, 0.4900360405445099],
        'epochs': np.arange(1, N_epochs_DL + 1)
        },
    'GRU': {
        'Train_Acc': [0.6213217377662659, 0.6669339537620544, 0.6999589800834656, 0.7201170921325684, 0.7306343913078308, 0.7355387210845947, 0.7421773076057434, 0.749170184135437, 0.7505874037742615, 0.7592585682868958, 0.7660649418830872, 0.7750531435012817, 0.7823257446289062, 0.7927311658859253, 0.7992578148841858],
        'Train_Loss': [0.6429013013839722, 0.6041003465652466, 0.5689570307731628, 0.5471254587173462, 0.5348019003868103, 0.5247704982757568, 0.5168247818946838, 0.5081308484077454, 0.5007929801940918, 0.4914919137954712, 0.48006004095077515, 0.4677404463291168, 0.4556715786457062, 0.4405488669872284, 0.4284902513027191],
        'Val_Acc': [0.6533154249191284, 0.6887446641921997, 0.7168643474578857, 0.7260386347770691, 0.7261132001876831, 0.7211904525756836, 0.7399119734764099, 0.7393898963928223, 0.7407324314117432, 0.7483404278755188, 0.7560975551605225, 0.7591556906700134, 0.761766254901886, 0.7646005749702454, 0.7766092419624329],
        'Val_Loss': [0.6187076568603516, 0.5827844738960266, 0.5490217208862305, 0.5335297584533691, 0.5327761173248291, 0.5384032726287842, 0.5155289769172668, 0.5136852860450745, 0.5168256163597107, 0.5027708411216736, 0.49224549531936646, 0.49350813031196594, 0.4883711636066437, 0.4756390154361725, 0.47282448410987854],
        'epochs': np.arange(1, N_epochs_DL + 1)
        }
}

models_data2 = {
    'BERT_base': {
        'Train_Acc': [0.859862744808197, 0.9261179566383362, 0.9485883712768555, 0.9597583413124084],
        'Train_Loss': [0.33491596579551697, 0.19638070464134216, 0.13940657675266266, 0.1081836074590683],
        'Val_Acc': [0.9113895893096924, 0.9249645471572876, 0.9264563322067261, 0.9275005459785461],
        'Val_Loss': [0.2287985384464264, 0.20946374535560608, 0.21739661693572998, 0.23172101378440857],
        'epochs': np.arange(1, N_epochs_TF + 1)
    },
    'distilBERT': {
        'Train_Acc': [0.8555551171302795, 0.9225562214851379, 0.9465371370315552, 0.9575579166412354],
        'Train_Loss': [0.3417491912841797, 0.20429827272891998, 0.14480571448802948, 0.11123823374509811],
        'Val_Acc': [0.9027373790740967, 0.9227269291877747, 0.9246662259101868, 0.9268292784690857],
        'Val_Loss': [0.25150856375694275, 0.20678342878818512, 0.21620914340019226, 0.21741342544555664],
        'epochs': np.arange(1, N_epochs_TF + 1)
    },
    'ELECTRA': {
        'Train_Acc': [0.8452243208885193, 0.9145377278327942, 0.9360571503639221, 0.9507142305374146],
        'Train_Loss': [0.35446834564208984, 0.22629167139530182, 0.1710481345653534, 0.13610687851905823],
        'Val_Acc': [0.905422568321228, 0.9241440892219543, 0.9305586814880371, 0.9283210039138794],
        'Val_Loss': [0.2407425194978714, 0.2144194394350052, 0.19465497136116028, 0.2516426146030426],
        'epochs': np.arange(1, N_epochs_TF + 1)
    }
 
}

models_data0 = {
    'MLP': {
        'Train_Acc': [0.7403125166893005, 0.782474935054779, 0.7919479608535767, 0.797448992729187, 0.8025770783424377, 0.8104836940765381, 0.8125908970832825, 0.8154439926147461, 0.8187446594238281, 0.8199753761291504, 0.8233879208564758, 0.8263342380523682, 0.826968252658844, 0.8285160064697266, 0.8310893774032593],
        'Train_Loss': [0.5280630588531494, 0.47458919882774353, 0.4571123719215393, 0.4461638331413269, 0.4389374852180481, 0.42645901441574097, 0.42202961444854736, 0.41501903533935547, 0.4105319678783417, 0.4069584906101227, 0.40163853764533997, 0.397494912147522, 0.3950704336166382, 0.3931514322757721, 0.3866216540336609],
        'Val_Acc': [0.7908555269241333, 0.7976430058479309, 0.8045796751976013, 0.810024619102478, 0.8169612884521484, 0.816364586353302, 0.8210636377334595, 0.8229283094406128, 0.8280748724937439, 0.8277019262313843, 0.8301633596420288, 0.8329976797103882, 0.8338927626609802, 0.8353099226951599, 0.8388901352882385],
        'Val_Loss': [0.45460209250450134, 0.44094109535217285, 0.4286123812198639, 0.41882094740867615, 0.4111679494380951, 0.4118380546569824, 0.3989301025867462, 0.39399710297584534, 0.3900335729122162, 0.3907005786895752, 0.3888159990310669, 0.38258111476898193, 0.3830885887145996, 0.3794887959957123, 0.376716285943985],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'CNN': {
        'Train_Acc': [0.646421492099762, 0.6948494911193848, 0.7087420225143433, 0.7176369428634644, 0.7218140363693237, 0.7275575399398804, 0.7313616275787354, 0.7354641556739807, 0.7429978251457214, 0.7445828318595886, 0.7471562027931213, 0.7517995238304138, 0.7527132630348206, 0.7565733194351196, 0.7581583857536316],
        'Train_Loss': [0.6268441677093506, 0.5818923115730286, 0.5614352822303772, 0.5528185367584229, 0.5451001524925232, 0.5373831987380981, 0.5297794938087463, 0.5251173377037048, 0.5182890892028809, 0.5116629004478455, 0.5095157623291016, 0.5029621124267578, 0.4999683201313019, 0.49738186597824097, 0.4924934506416321],
        'Val_Acc': [0.6976206302642822, 0.7117177844047546, 0.7083613276481628, 0.7128365635871887, 0.7170134782791138, 0.7094055414199829, 0.7329753041267395, 0.7322294116020203, 0.7367047071456909, 0.7110464572906494, 0.7428954839706421, 0.734541654586792, 0.7391660809516907, 0.7505780458450317, 0.7483404278755188],
        'Val_Loss': [0.5866148471832275, 0.5609935522079468, 0.5543216466903687, 0.5614852905273438, 0.5480287075042725, 0.5578920245170593, 0.5274492502212524, 0.5268547534942627, 0.5222018361091614, 0.5560338497161865, 0.5187031626701355, 0.5278877019882202, 0.5150685906410217, 0.5069602131843567, 0.5053796172142029],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'RNN': {
        'Train_Acc': [0.7236228585243225, 0.743370771408081, 0.7547085285186768, 0.7594823241233826, 0.7644426226615906, 0.768284022808075, 0.7724051475524902, 0.7771230340003967, 0.7801812291145325, 0.7843769788742065, 0.7828665375709534, 0.7863536477088928, 0.7902323603630066, 0.789113461971283, 0.7967404127120972],
        'Train_Loss': [0.5389851927757263, 0.5168284773826599, 0.4989835321903229, 0.4912647306919098, 0.4838959872722626, 0.48041024804115295, 0.4741634726524353, 0.46435311436653137, 0.46113651990890503, 0.4520343244075775, 0.45669835805892944, 0.451353520154953, 0.4480915069580078, 0.4486345648765564, 0.4340810179710388],
        'Val_Acc': [0.7262623906135559, 0.7478182911872864, 0.7303647398948669, 0.7613933086395264, 0.751398503780365, 0.7472962141036987, 0.7645260095596313, 0.7710151672363281, 0.7751174569129944, 0.7725068926811218, 0.7704930305480957, 0.7746699452400208, 0.7843663692474365, 0.78168123960495, 0.779518187046051],
        'Val_Loss': [0.530576765537262, 0.5051789283752441, 0.5344845652580261, 0.4825063943862915, 0.5081067085266113, 0.5046193599700928, 0.48668283224105835, 0.4791106879711151, 0.4680091440677643, 0.48473548889160156, 0.4801090955734253, 0.47036635875701904, 0.45508816838264465, 0.4570018947124481, 0.4553026258945465],
        'epochs': np.arange(1, N_epochs_DL + 1)
    },
    'LSTM': {
        'Train_Acc': [0.6187297105789185, 0.6831014752388, 0.696341335773468, 0.7095625400543213, 0.7195203900337219, 0.7311565279960632, 0.7379629015922546, 0.7455898523330688, 0.752135157585144, 0.757375180721283, 0.7652444839477539, 0.7700182795524597, 0.7753515243530273, 0.779994785785675, 0.788199782371521],
        'Train_Loss': [0.6441648006439209, 0.5906595587730408, 0.5731194019317627, 0.5584167242050171, 0.5477322936058044, 0.5338645577430725, 0.5228525400161743, 0.5133535265922546, 0.504418134689331, 0.4956718385219574, 0.48670339584350586, 0.47805875539779663, 0.4686107933521271, 0.4592962861061096, 0.44851982593536377],
        'Val_Acc': [0.6640560626983643, 0.6884463429450989, 0.7023942470550537, 0.7130603194236755, 0.7254419326782227, 0.7317818999290466, 0.7298426032066345, 0.7211904525756836, 0.7501305341720581, 0.7426717281341553, 0.7548295855522156, 0.754456639289856, 0.7569180130958557, 0.766017735004425, 0.7604236602783203],
        'Val_Loss': [0.6069639921188354, 0.5808297395706177, 0.5659984350204468, 0.5521641969680786, 0.540982723236084, 0.5253297090530396, 0.5313506722450256, 0.5343418717384338, 0.5043997168540955, 0.5157902240753174, 0.4970165193080902, 0.49426549673080444, 0.4935286343097687, 0.48192816972732544, 0.4900360405445099],
        'epochs': np.arange(1, N_epochs_DL + 1)
        },
    'GRU': {
        'Train_Acc': [0.6213217377662659, 0.6669339537620544, 0.6999589800834656, 0.7201170921325684, 0.7306343913078308, 0.7355387210845947, 0.7421773076057434, 0.749170184135437, 0.7505874037742615, 0.7592585682868958, 0.7660649418830872, 0.7750531435012817, 0.7823257446289062, 0.7927311658859253, 0.7992578148841858],
        'Train_Loss': [0.6429013013839722, 0.6041003465652466, 0.5689570307731628, 0.5471254587173462, 0.5348019003868103, 0.5247704982757568, 0.5168247818946838, 0.5081308484077454, 0.5007929801940918, 0.4914919137954712, 0.48006004095077515, 0.4677404463291168, 0.4556715786457062, 0.4405488669872284, 0.4284902513027191],
        'Val_Acc': [0.6533154249191284, 0.6887446641921997, 0.7168643474578857, 0.7260386347770691, 0.7261132001876831, 0.7211904525756836, 0.7399119734764099, 0.7393898963928223, 0.7407324314117432, 0.7483404278755188, 0.7560975551605225, 0.7591556906700134, 0.761766254901886, 0.7646005749702454, 0.7766092419624329],
        'Val_Loss': [0.6187076568603516, 0.5827844738960266, 0.5490217208862305, 0.5335297584533691, 0.5327761173248291, 0.5384032726287842, 0.5155289769172668, 0.5136852860450745, 0.5168256163597107, 0.5027708411216736, 0.49224549531936646, 0.49350813031196594, 0.4883711636066437, 0.4756390154361725, 0.47282448410987854],
        'epochs': np.arange(1, N_epochs_DL + 1)
        },
    'BERT_base': {
        'Train_Acc': [0.859862744808197, 0.9261179566383362, 0.9485883712768555, 0.9597583413124084],
        'Train_Loss': [0.33491596579551697, 0.19638070464134216, 0.13940657675266266, 0.1081836074590683],
        'Val_Acc': [0.9113895893096924, 0.9249645471572876, 0.9264563322067261, 0.9275005459785461],
        'Val_Loss': [0.2287985384464264, 0.20946374535560608, 0.21739661693572998, 0.23172101378440857],
        'epochs': np.arange(1, N_epochs_TF + 1)
    },
    'distilBERT': {
        'Train_Acc': [0.8555551171302795, 0.9225562214851379, 0.9465371370315552, 0.9575579166412354],
        'Train_Loss': [0.3417491912841797, 0.20429827272891998, 0.14480571448802948, 0.11123823374509811],
        'Val_Acc': [0.9027373790740967, 0.9227269291877747, 0.9246662259101868, 0.9268292784690857],
        'Val_Loss': [0.25150856375694275, 0.20678342878818512, 0.21620914340019226, 0.21741342544555664],
        'epochs': np.arange(1, N_epochs_TF + 1)
    },
    'ELECTRA': {
        'Train_Acc': [0.8452243208885193, 0.9145377278327942, 0.9360571503639221, 0.9507142305374146],
        'Train_Loss': [0.35446834564208984, 0.22629167139530182, 0.1710481345653534, 0.13610687851905823],
        'Val_Acc': [0.905422568321228, 0.9241440892219543, 0.9305586814880371, 0.9283210039138794],
        'Val_Loss': [0.2407425194978714, 0.2144194394350052, 0.19465497136116028, 0.2516426146030426],
        'epochs': np.arange(1, N_epochs_TF + 1)
    }
 
}

# Function to plot the data in a 2x2 grid with normalized epochs
def plot_model_performance(models_data):
    # Create a 2x2 subplot
    fig, axs = plt.subplots(2, 2, figsize=(15, 10))
    fig.suptitle("Model Performance Over Epochs", fontsize=16, y=0.95)
    
    # Plot configurations
    metrics = ['Train_Loss', 'Val_Loss', 'Train_Acc', 'Val_Acc']
    titles = ['Train Loss', 'Test Loss', 'Train Accuracy', 'Test Accuracy']
    
    # Iterate over the metrics and plot each one in a subplot
    for i, metric in enumerate(metrics):
        ax = axs[i//2, i%2]  # Determine the correct subplot
        ax.set_title(titles[i])
        ax.set_xlabel('Epochs', labelpad=10)
        ax.set_ylabel(metric.split('_')[0])
        
        for model_name, data in models_data.items():
            values = data[metric]
            # Normalize the epochs if required
            normalized_epochs = np.linspace(1, max(data['epochs']), num=len(values))

            # Plot the data
            ax.plot(normalized_epochs, values, label=model_name, marker='o')
            ax.legend(fontsize=10)
            ax.grid(True)
    
    # Adjust layout to prevent overlap
    plt.tight_layout()
    plt.subplots_adjust(top=0.88)  # Adjust the top spacing to prevent title overlap
    plt.savefig(r"C:\Users\Usuario\Desktop\TF_train_val_plots.png", dpi=300, bbox_inches='tight')
    plt.show()

#plot_model_performance(models_data1)
plot_model_performance(models_data2)
#plot_model_performance(models_data0)